# 想法: 系统可观测性

状态: 已批准

## 原始想法

TokMesh 必须具备生产级的**可观测性 (Observability)**，以便运维人员实时掌握系统健康状况。

### 监控指标 (Metrics)
*   **Prometheus 集成**: 原生暴露 `/metrics` 端点，遵循 Prometheus 格式标准。
*   **关键指标**:
    *   **业务指标**: QPS、Token 校验成功/失败率、当前在线会话数。
    *   **性能指标**: 接口响应延迟 (P99/P95/P50)、GC 暂停时间。
    *   **资源指标**: 内存使用率、CPU 使用率、Goroutine 数量。
    *   **存储指标**: WAL 写入速度、内存使用、快照状态。

### 日志 (Logging)
*   **结构化**: 所有日志输出均为 JSON 格式，便于 ELK/Loki 等日志系统收集与分析。
*   **分级**: 支持动态调整日志级别 (Debug/Info/Warn/Error)。
*   **Trace**: 关键链路支持 Request ID 贯穿，便于分布式链路追踪。
