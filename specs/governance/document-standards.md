# 文档编号与管理规范

版本: 1.2
状态: 已定稿
更新日期: 2025-12-15

## 1. 文档类型

| 代码 | 类型名称 (En) | 类型名称 (Cn) | 存储目录 |
| :--- | :--- | :--- | :--- |
| **CP** | Capture | 想法捕捉 | `specs/0-captures/` |
| **RQ** | Requirement | 需求规约 | `specs/1-requirements/` |
| **DS** | Design | 技术设计 | `specs/2-designs/` |
| **TK** | Task | 开发任务 | `specs/3-tasks/` |
| **AD** | ADR | 架构决策 | `specs/adrs/` |
| **OP** | Operation | 运维手册 | `specs/operations/` |
| **TM** | Term | 术语定义 | `specs/governance/glossaries/terms/` |

## 2. 分层编号格式（推荐）

> TokMesh 项目采用 **分层编号规则** 统一管理文档编号。少量历史文档仍可能保留旧编号，仅作档案用途；新文档与重构文档必须使用本节规则。

### 2.1 统一格式

**格式**: `<type>-<lev><seq>-<slug>.md`

- `type`: 文档类型，沿用第 1 节中的 2 字母代码，例如 `CP` / `RQ` / `DS` / `TK` / `AD` / `OP`。
- `lev`: **两位数字的分层编码**，表示文档所在的功能层级（见 2.2）。
- `seq`: 相同 `type+lev` 下的流水号，推荐使用 2 位数字（`01`-`99`）。
- `slug`: 标题摘要，**推荐使用中文短语**以便快速识别内容（如 `会话管理功能` 优于 `session-management`）。

### 2.2 分层编码（LEV）

分层编码在所有文档类型之间共享含义，用于快速识别“这份文档属于哪一层”：

| LEV | 层级名称       | 说明 |
|-----|----------------|------|
| `01` | 系统基础       | 核心数据模型、ID 规范、全局错误码等全局基础规则。 |
| `02` | 安全基础       | API Key、鉴权策略、防重放、加密等安全相关规范。 |
| `03` | 接口与集成     | 对外接口族（OpenAPI/Redis/Admin）、外部系统集成。 |
| `04` | 架构与质量     | 分布式架构、集群行为、性能与可靠性等整体质量目标。 |
| `05` | 运维与交付     | 部署形态、配置管理、运维工具、环境约束。 |
| `06` | 客户端接入     | 客户端接入规范与工具使用（以 HTTP/HTTPS 与 `tokmesh-cli` 为主；当前范围不包含官方 SDK）。 |

> 说明：
> - `LEV` 不表达时间，只表达“在体系中的位置”，便于跨文档类型建立心智模型。
> - 同一 `LEV` 下可以有多个 `type` 文档，例如：`RQ-0301-业务接口规约-OpenAPI.md` 与 `DS-0301-接口与协议层设计.md` 都属于“接口与集成”层。

### 2.3 序号（seq）约定

- 同一 `type+lev` 下的文档按业务逻辑或创建顺序从 `01` 递增，例如：
  - `RQ-0101-核心数据模型.md`
  - `RQ-0102-会话生命周期管理.md`
  - `specs/governance/error-codes.md`
- 一般不要求全局连续，只需在同一层内无明显冲突即可。

### 2.4 示例（推荐）

- `RQ-0101-核心数据模型.md`（需求，系统基础层）
- `RQ-0201-安全与鉴权体系.md`（需求，安全基础层）
- `RQ-0301-业务接口规约-OpenAPI.md`（需求，接口层）
- `DS-0101-核心数据模型设计.md`（设计，对应 RQ-0101）
- `DS-0401-分布式集群架构设计.md`（设计，架构层）
- `TK-0301-实现OpenAPI接口.md`（任务，接口实现）

## 3. 文档生命周期

### 3.1 状态流转

每个文档应在文件头部的 YAML Front Matter 或元数据区包含 `状态` 字段（推荐使用中文取值以保持一致性）。

- **草稿**: 正在编写，内容未定。（Draft）
- **评审中**: 已提交，等待团队或架构师评审。（Review）
- **已批准**: 评审通过，可以作为后续工作的依据。（Approved）
- **实施中**: (仅限 TK/RQ) 对应的开发工作正在进行。（In Progress）
- **已完成**: (仅限 TK) 开发完成并通过验证。（Completed）
- **已废弃**: 不再适用或已被新文档取代。（Deprecated）

### 3.2 变更管理

- **小修改**: 直接在原文档修改，并在文末“修订历史”增加记录。
- **大重构**:
    - 如果是需求变更导致设计彻底推翻，建议将旧文档标记为 `Deprecated`，并创建新编号的文档。
    - 在新文档头部注明 `Replaces: [旧文档编号]`。
